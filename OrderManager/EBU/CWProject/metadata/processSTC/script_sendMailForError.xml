<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="91b2ae9ea36d8040822cdeb482b2fdf5" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="processSTC.sendMailForError">
  <guid>{0199fa91-b4a7-d36d-d541-ac2906f5e185}</guid>
  <label>Send Mail For Error</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="errorMessage" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="mailReceiver" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var debugHeader = " Send E-Mail alert for Error - ";

    debugPrintln("[" + common.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debugHeader + "Check to Send E-Mail");
          if(mailReceiver != null) {
                var from     = Global.getConfigVariable("SENDER_FOR_ERROR"); // mail address of the sender
                var subject  = Global.translateText("SUBJECT_FOR_ERROR");  // "Expediter caught an error"
                var host     = Global.getConfigVariable("MAIL_SERVER"); // mail server address
                var mimeType = "text/plain"; // mail plain text
                var user     = Global.getConfigVariable("USER_ID_MAIL_SERVER"); // user id to login to mail server
                var password = Global.getConfigPassword("PASSWORD_MAIL_SERVER"); // password of the user to login to mail server
                var port     = Global.getConfigVariable("PORT_MAIL_SERVER"); // the listening port of the mail server
                var secure   = Global.getConfigVariable("SECURE_MAIL_SERVER"); // YES means that the mail server requires SSL

                try {
    debugPrintln("[" + common.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debugHeader + "Sending to " + mailReceiver);
                      Global.sendEmail(from, mailReceiver, subject, errorMessage, host, mimeType, user, password, port, (secure != null && secure == "YES"));
    debugPrintln("[" + common.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debugHeader + "Sent!");
                }
                catch(exc) {
                      Global.logDebug("Error in sending E-Mail <" + errorMessage + "> for Error - msg = " + exc.message);
    debugPrintln("[" + common.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debugHeader + "Error in sending E-Mail <" + errorMessage + "> for Error - msg = " + exc.message);
                }
          }
  ]]></script>
</script>