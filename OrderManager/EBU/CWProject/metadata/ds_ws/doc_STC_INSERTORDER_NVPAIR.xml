<?xml version="1.0" encoding="UTF-8" ?>
<document filenameHash="9b07c05c1f8cef54ada1b186c29a00f3" versionHash="a87ff679a2f3e71d9181a67b7542122c" name="ds_ws.STC_INSERTORDER_NVPAIR">
  <dbSchema>ORDER</dbSchema>
  <extends>doc_com.conceptwave.system.Document</extends>
  <generatedKey>true</generatedKey>
  <guid>{26e5416e-4f8d-4fa8-af28-20b5c4d1bc5b}</guid>
  <label>NV Pair For Insert Orders From GUI</label>
  <metaVersion>4</metaVersion>
  <variableList>
    <variable name="cwDocId" type="leaf">
      <column>CWDOCID</column>
      <key>1</key>
      <table>STC_INSERTORDER_NVPAIR</table>
      <valueType>dtype_cwf.cwDocId</valueType>
    </variable>
    <variable name="name" type="leaf">
      <column>NAME</column>
      <propertyElement type="elfld">
        <editable type="varPath">
          <variablePathList>
            <variablePath>dtype_com.conceptwave.system.Boolean/leaf_FALSE</variablePath>
          </variablePathList>
        </editable>
        <label>Name</label>
        <optional type="varPath">
          <variablePathList>
            <variablePath>dtype_com.conceptwave.system.Boolean/leaf_FALSE</variablePath>
          </variablePathList>
        </optional>
      </propertyElement>
      <table>STC_INSERTORDER_NVPAIR</table>
      <valueType>dtype_ds_ws.string100</valueType>
    </variable>
    <variable name="value" type="leaf">
      <column>VALUE</column>
      <propertyElement type="elfld">
        <label>Value</label>
      </propertyElement>
      <table>STC_INSERTORDER_NVPAIR</table>
      <valueType>dtype_ds_ws.string4000</valueType>
    </variable>
    <variable name="headerId" type="leaf">
      <column>HEADER_ID</column>
      <table>STC_INSERTORDER_NVPAIR</table>
      <valueType>dtype_cwf.docId</valueType>
    </variable>
    <variable name="mandatory" type="leaf">
      <dontMap>true</dontMap>
      <propertyElement type="elchk">
        <label>Mandatory</label>
      </propertyElement>
      <valueType>dtype_com.conceptwave.system.Boolean</valueType>
    </variable>
    <variable name="mandatoryOn" type="leaf">
      <dontMap>true</dontMap>
      <propertyElement type="elfld">
        <label>Mandatory On</label>
      </propertyElement>
      <valueType>dtype_ds_ws.string100</valueType>
    </variable>
    <variable name="mandatoryOnValue" type="leaf">
      <dontMap>true</dontMap>
      <propertyElement type="elfld">
        <label>Mandatory On Value</label>
      </propertyElement>
      <valueType>dtype_ds_ws.string4000</valueType>
    </variable>
    <variable name="valueTypeForNVPair4GUI" type="leaf">
      <dontMap>true</dontMap>
      <propertyElement type="elslct">
        <label>Value Type</label>
        <sorted>false</sorted>
      </propertyElement>
      <valueType>dtype_ds_ws.valueTypeForNVPair4GUI</valueType>
    </variable>
    <variable name="valuesForLoV" type="leaf">
      <dontMap>true</dontMap>
      <propertyElement type="elfld">
        <label>Values For LoV</label>
      </propertyElement>
      <valueType>dtype_ds_ws.string4000</valueType>
    </variable>
    <variable name="finderName" type="leaf">
      <dontMap>true</dontMap>
      <propertyElement type="elfld">
        <label>Finder Name</label>
      </propertyElement>
      <valueType>dtype_ds_ws.string256</valueType>
    </variable>
  </variableList>
  <UserInterface name="UserInterface" type="ui">
    <extends>doc_com.conceptwave.system.Document/ui_UserInterface</extends>
    <variableList>
      <variable name="listOfValueForInsertOrderFromGUI" type="leaf">
        <flags enum-type="metadataFlag">ARRAY</flags>
        <valueType>doc_ds_ws.listOfValueForInsertOrderFromGUI</valueType>
      </variable>
      <variable name="model" type="uivar">
        <label>model</label>
        <valueType>doc_ds_ws.STC_INSERTORDER_NVPAIR</valueType>
      </variable>
      <variable name="finderCustomQueryForNVPairUserInterface" type="leaf">
        <valueType>findScript_ds_ws.findCustomQueryForNVPair4GUI/ui_UserInterface</valueType>
      </variable>
    </variableList>
    <vformList>
      <vform name="Forms" type="frmui">
        <extends>doc_com.conceptwave.system.Document/ui_UserInterface/frmui_Forms</extends>
        <overlayList>
          <overlay name="Default" type="exov">
            <base>ui_com.conceptwave.system.DocumentUserInterface/frmui_Forms/exov_Default</base>
            <extends>ui_com.conceptwave.system.DocumentUserInterface/frmui_Forms/exov_Default</extends>
            <label>Default</label>
            <overrideList>
              <override name="VerticalLayout" type="elvlt">
                <elementList>
                  <element name="textFormFrame" type="elovf">
                    <formReference type="varPath">
                      <variablePathList>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/frmui_Forms</variablePath>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/frmui_Forms/vform_textNVPair</variablePath>
                      </variablePathList>
                    </formReference>
                    <visible type="varPath">
                      <variablePathList>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/permMethod_isText</variablePath>
                      </variablePathList>
                    </visible>
                  </element>
                  <element name="lovFormFrame" type="elovf">
                    <formReference type="varPath">
                      <variablePathList>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/frmui_Forms</variablePath>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/frmui_Forms/vform_listOfValuesNVPair</variablePath>
                      </variablePathList>
                    </formReference>
                    <visible type="varPath">
                      <variablePathList>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/permMethod_isLoV</variablePath>
                      </variablePathList>
                    </visible>
                  </element>
                  <element name="finderCustomFormFrame" type="elovf">
                    <formReference type="varPath">
                      <variablePathList>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/frmui_Forms</variablePath>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/frmui_Forms/vform_finderCustomNVPair</variablePath>
                      </variablePathList>
                    </formReference>
                    <visible type="varPath">
                      <variablePathList>
                        <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/permMethod_isCustomFinder</variablePath>
                      </variablePathList>
                    </visible>
                  </element>
                </elementList>
              </override>
            </overrideList>
          </overlay>
          <overlay name="textNVPair" type="vform">
            <label>textNVPair</label>
            <root name="VerticalLayout" type="elvlt">
              <elementList>
                <element name="GridLayout" type="elgrd">
                  <colWidths>120px,180px</colWidths>
                  <labelOrientation>left</labelOrientation>
                  <numOfCols>2</numOfCols>
                  <width>300px</width>
                  <elementList>
                    <element name="textNVPairAttributeValueHeader" type="elhdr">
                      <label>NV Pairs</label>
                      <showValidation>true</showValidation>
                    </element>
                    <element name="value" type="elfld">
                      <variable type="varPath">
                        <variablePathList>
                          <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/uivar_model</variablePath>
                          <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/leaf_value</variablePath>
                        </variablePathList>
                      </variable>
                    </element>
                  </elementList>
                </element>
              </elementList>
            </root>
          </overlay>
          <overlay name="Menu" type="exov">
            <base>doc_com.conceptwave.system.Document/ui_UserInterface/frmui_Forms/exov_Menu</base>
            <extends>doc_com.conceptwave.system.Document/ui_UserInterface/frmui_Forms/exov_Menu</extends>
            <label>Menu</label>
            <overrideList>
              <override name="cwfSave" type="elmnu">
                <menuAccel type="mAccelP"/>
                <clickMethod type="varPath">
                  <variablePathList>
                    <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/usrActionMethod_storeNVPair</variablePath>
                  </variablePathList>
                </clickMethod>
                <icon>/cwf/MenuIconSave.gif</icon>
                <label>Save</label>
                <showDown>true</showDown>
                <tooltip>Save</tooltip>
              </override>
            </overrideList>
          </overlay>
          <overlay name="listOfValuesNVPair" type="vform">
            <label>listOfValuesNVPair</label>
            <root name="VerticalLayout" type="elvlt">
              <elementList>
                <element name="GridLayout" type="elgrd">
                  <colWidths>120px,180px</colWidths>
                  <labelOrientation>left</labelOrientation>
                  <numOfCols>2</numOfCols>
                  <width>300px</width>
                  <elementList>
                    <element name="finderNVPairAttributeValueHeader" type="elhdr">
                      <label>NV Pair - List Of Value</label>
                      <showValidation>true</showValidation>
                    </element>
                  </elementList>
                </element>
                <element name="Table" type="eltabl">
                  <headerHeight>20</headerHeight>
                  <height>600px</height>
                  <variable type="varPath">
                    <variablePathList>
                      <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/leaf_listOfValueForInsertOrderFromGUI</variablePath>
                    </variablePathList>
                  </variable>
                  <width>800px</width>
                  <elementList>
                    <element name="configuredValue" type="elfld">
                      <label>Configured Value</label>
                      <variable type="varPath">
                        <variablePathList>
                          <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/leaf_listOfValueForInsertOrderFromGUI</variablePath>
                          <variablePath>doc_ds_ws.listOfValueForInsertOrderFromGUI/leaf_configuredValue</variablePath>
                        </variablePathList>
                      </variable>
                      <width>100%</width>
                    </element>
                  </elementList>
                </element>
              </elementList>
            </root>
          </overlay>
          <overlay name="finderCustomNVPair" type="vform">
            <label>finderCustomNVPair</label>
            <root name="VerticalLayout" type="elvlt">
              <elementList>
                <element name="GridLayout" type="elgrd">
                  <colWidths>120px,180px</colWidths>
                  <labelOrientation>left</labelOrientation>
                  <numOfCols>2</numOfCols>
                  <width>300px</width>
                  <elementList>
                    <element name="finderNVPairAttributeValueHeader" type="elhdr">
                      <label>NV Pair - All Values found with Custom Finder</label>
                      <showValidation>true</showValidation>
                    </element>
                  </elementList>
                </element>
                <element name="FormFrame" type="elovf">
                  <formReference type="varPath">
                    <variablePathList>
                      <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/leaf_finderCustomQueryForNVPairUserInterface</variablePath>
                      <variablePath>findScript_ds_ws.findCustomQueryForNVPair4GUI/ui_UserInterface/frmui_Forms</variablePath>
                      <variablePath>findScript_ds_ws.findCustomQueryForNVPair4GUI/ui_UserInterface/frmui_Forms/exov_Result</variablePath>
                    </variablePathList>
                  </formReference>
                  <height>600px</height>
                  <variable type="varPath">
                    <variablePathList>
                      <variablePath>doc_ds_ws.STC_INSERTORDER_NVPAIR/ui_UserInterface/leaf_finderCustomQueryForNVPairUserInterface</variablePath>
                    </variablePathList>
                  </variable>
                  <width>800px</width>
                </element>
              </elementList>
            </root>
          </overlay>
        </overlayList>
      </vform>
    </vformList>
    <methodList>
      <method name="isText" type="permMethod">
        <script><![CDATA[return (this.model.valueTypeForNVPair4GUI == "Text");]]></script>
      </method>
      <method name="isLoV" type="permMethod">
        <script><![CDATA[return (this.model.valueTypeForNVPair4GUI == "LoV");]]></script>
      </method>
      <method name="storeNVPair" type="usrActionMethod">
        <script><![CDATA[
          if(this.model.valueTypeForNVPair4GUI == "Text") {
              // do nothing
          }
          else if(this.model.valueTypeForNVPair4GUI == "LoV") {
              var selectedItem = this.listOfValueForInsertOrderFromGUI.selected;
              if(selectedItem == null || selectedItem.length == 0) {
                  Global.throwException("UU0115");
              }
              else if(selectedItem.length > 1) {
                  Global.throwException("UU0116");
              }
              this.model.value = selectedItem[0].configuredValue;
          }
          else if(this.model.valueTypeForNVPair4GUI == "Finder") {
              var selectedItem = this.finderCustomQueryForNVPairUserInterface.result.selected;

              if(selectedItem == null || selectedItem.length == 0) {
                  Global.throwException("UU0115");
              }
              else if(selectedItem.length > 1) {
                  Global.throwException("UU0116");
              }

              // custom finder
              this.model.value = selectedItem[0].result;
          }

          ds_ws.storeNVPair4GUI(this.model.id, this.model.name, this.model.value, this.model.headerId);

          this.model.parent.search();
          return Global.STOP_UI;
        ]]></script>
      </method>
      <method name="onInit" type="action">
        <valueType>nmeta_com.conceptwave.system.Object</valueType>
        <script><![CDATA[
          var resultSuperOnInit = this.cw$super_onInit();

          if(this.model.valueTypeForNVPair4GUI == "Finder") {
              // custom finder
              this.finderCustomQueryForNVPairUserInterface = new ds_ws.findCustomQueryForNVPair4GUI.UserInterface(null, this);
              this.finderCustomQueryForNVPairUserInterface.search.model.inputData = this.model.finderName;
              var result = this.finderCustomQueryForNVPairUserInterface.model.search();

              for(var i=0; i<result.length; i++) {
                  if(result[i].result == this.model.value) {
                      result.setSelected(result[i]);
                  }
              }
          }
          else if(this.model.valueTypeForNVPair4GUI == "LoV") {

              if(this.model.valuesForLoV != null) {
                  this.listOfValueForInsertOrderFromGUI = new DataObjectList();

                  var values = this.model.valuesForLoV.split(";");
                  for(var i=0; i<values.length; i++) {
                      var doc = new ds_ws.listOfValueForInsertOrderFromGUI();
                      doc.configuredValue = values[i];
                      this.listOfValueForInsertOrderFromGUI.add(i, doc);

                      if(values[i] == this.model.value) {
                          this.listOfValueForInsertOrderFromGUI.setSelected(doc);
                      }
                  }
              }
          }


          return resultSuperOnInit;
        ]]></script>
      </method>
      <method name="isCustomFinder" type="permMethod">
        <script><![CDATA[
          var isCustomFinder = (this.model.valueTypeForNVPair4GUI == "Finder");

          return isCustomFinder;
        ]]></script>
      </method>
      <method name="editablePerm" type="permMethod">
        <script><![CDATA[
          var result = this.cw$super_editablePerm($psCondition);

          var searchDoc = new Document("cwt_common.docID");
          searchDoc.cwDocID = this.model.headerId;

          var jobId = null;
          var resultFinder = Finder.runFinder("ds_ws.findInsertFeasibilityOrder", "select", searchDoc);
          if(resultFinder != null && resultFinder.length > 0) {
              if(resultFinder[0].jobId != null) {
                  result = false;
              }
          }

          return result;
        ]]></script>
      </method>
    </methodList>
  </UserInterface>
</document>