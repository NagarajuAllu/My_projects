<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="72fe4586192a1d40382e4d2d4853bff9" versionHash="a87ff679a2f3e71d9181a67b7542122c" name="ds_ws.validateNVPairValueForServiceTypeInPickList">
  <label>Validate NV Pair Value For ServiceType In PickList</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="serviceType" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="lineItemIdentifier" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="nvPairName" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="value" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="isSubmit" type="rifp">
      <type>dtype_com.conceptwave.system.Boolean</type>
    </parameter>
    <parameter name="failureArray" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <valueType>dtype_com.conceptwave.system.Boolean</valueType>
  <script><![CDATA[
    if(serviceType != null && value != null) {
        var queryDoc = new Document("ds_ws:search_NVPair_ServiceType_picklistDoc");
        queryDoc.serviceType = serviceType;
        queryDoc.nvpair_name = nvPairName;
        var resultList = Finder.runFinder("ds_ws:findNVPair_ServiceType_pickListForValidation", "select", queryDoc);

        var found = false;

        if(resultList != null && resultList.length > 0) {
            for(var i=0; i<resultList.length && !found; i++) {
                found = (resultList[i].value == value);
            }
        }
        else {
            found = true;
        }

        if(!found) {
            var validationErrors = ["DE1107", "NV Pair \"" + nvPairName + "\": Invalid value in enumeration: " + value];
            failureArray = ds_ws.addValidationErrorsToFailureArrayForSub_UpdInWD(validationErrors, lineItemIdentifier, failureArray, isSubmit);
        }
    }

    return failureArray;
  ]]></script>
</script>