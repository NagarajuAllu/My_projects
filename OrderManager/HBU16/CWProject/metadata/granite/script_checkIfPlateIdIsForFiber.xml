<?xml version="1.0" encoding="UTF-8" ?>
<script name="granite.checkIfPlateIdIsForFiber">
  <label>Check If PlateID Is For Fiber</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="plateId" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    // a plateID for Fiber must:
    // has a name whose length is 11 chars
    // and the site with that name has NUM = "FIBER"
    var result = false;

    if(plateId != null) {
        if(plateId.length == 11) {
            var searchDoc = new Document("granite.searchSiteDoc");
            searchDoc.SITE_HUM_ID = plateId;
            searchDoc.NUM = "FIBER";

            var resultList = Finder.runFinder("granite.findSiteInGraniteByNameAndCategory", "select", searchDoc);
            if(resultList != null & resultList.length > 0) {
                result = true;
            }
        }
    }

    return result;
  ]]></script>
</script>