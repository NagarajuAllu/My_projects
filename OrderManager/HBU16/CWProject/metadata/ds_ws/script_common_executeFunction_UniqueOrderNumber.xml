<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="cb43095f7e8ae98e1f79eb67c3f4439f" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="ds_ws.common_executeFunction_UniqueOrderNumber">
  <guid>{08de122b-ee24-eab3-f55a-0b64a91bba72}</guid>
  <label>Common Methods: Execute Function &quot;Unique Order Number&quot;</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="databaseName" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="orderType" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="user" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    // Returns the order created from the incoming DataStructure
    var debug = "[COMMON METHOD: EXECUTE FUNCTION 'UNIQUE ORDER #']";
    debugPrintln("[" + ds_ws.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debug + " START...");

          var result = null;

          if (databaseName != null && orderType != null && user != null) {

                try {
                      // Invoke the function to retrieve a unique Order #:
                      // - the first input is the 'Order Type'
                      // - the second input is the 'User Initials' (hardcoded to 'ST')
                      var sql = "SELECT STC_OE_GEN_ORDER_NO('" + orderType + "', '" + user + "') FROM DUAL";
                      var output = Global.runSQLQuery(databaseName, "ds_ws:genericOutput_String", 1, null, sql);

                      if (output != null && output.size == 1) {
                            result = output.start.result;
    debugPrintln("[" + ds_ws.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debug + " RESULT # '" + result + "'...");
                      }
                }
                catch (exc) {
    debugPrintln("[" + ds_ws.common_currentDateAsStringDDMMYYYYHH24MISS() + "]" + debug + " [ERROR] EXCEPTION '" + exc.message + "'...");
                }

                Global.commitTransaction(databaseName);
          }

          return result;
  ]]></script>
</script>