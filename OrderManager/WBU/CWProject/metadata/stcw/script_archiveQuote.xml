<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="df575558fe6080c61d031a7fc0a8a641" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="stcw.archiveQuote">
  <guid>{0c0bdd4d-868b-39b6-0e8b-220a6dc2e0fb}</guid>
  <label>Archive Quote</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="givenOrder" type="rifp">
      <type>order_com.conceptwave.system.Order</type>
    </parameter>
    <parameter name="isError" type="rifp">
      <type>dtype_com.conceptwave.system.Boolean</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    givenOrder.header.orderNumber = givenOrder.header.orderNumber + "_" + stcc.getSysdateInYYYYMMDD();

    if(isError) {
          givenOrder.header.orderNumber    = givenOrder.header.orderNumber + "_ErrGranite";
          givenOrder.header.orderRowItemId = -givenOrder.header.orderRowItemId;
          givenOrder.header.orderComments  = (givenOrder.header.orderComments == null ? "" : givenOrder.header.orderComments + "\n") +
                                                             stcc.getSysdateInYYYYMMDD() + " - Quote AutoArchived Due Granite Error";
          givenOrder.header.quoteStatus    = "REJECTED";
    }
    else {
          givenOrder.header.orderComments = (givenOrder.header.orderComments == null ? "" : givenOrder.header.orderComments + "\n") +
                                                            stcc.getSysdateInYYYYMMDD() + " - Quote Archived by UserID: " + Global.getUserId();
          givenOrder.header.quoteStatus   = "ARCHIVED";
    }
    givenOrder.save();
  ]]></script>
</script>