<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="f158f9f36eb8a12431ac43ccc7339998" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="stcw.convertCRMValueToGraniteOne">
  <guid>{0255157b-ee78-dc18-acc3-286e26d61e65}</guid>
  <label>Convert CRM Value To Granite One</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="attributeName" type="rifp">
      <type>dtype_stcw.attributeName</type>
    </parameter>
    <parameter name="crmAttributeValue" type="rifp">
      <type>dtype_stcw.attributeValue</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var result = null;

    if(stcc.stringHasValue(crmAttributeValue)) {
          var convertValueFinder = new Finder ("stcw:convertCRMToGraniteValue");
          convertValueFinder.searchDocument.attributeName     = attributeName.toUpperCase();
          convertValueFinder.searchDocument.crmAttributeValue = crmAttributeValue.toUpperCase();
          convertValueFinder.search ();

          var resultList = convertValueFinder.list;

          if (resultList != null && resultList.size > 0) {
                result = resultList.start.graniteAttributeValue;
          }
          else {
                result = crmAttributeValue;
          }
    }

    return result;
  ]]></script>
</script>