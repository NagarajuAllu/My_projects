<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="fc5690f3aa197353655e3fbe6c4824e8" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="stcw.convertCRMNameToGraniteOne">
  <guid>{064028fe-b90a-c92e-15bd-99a7f06e9572}</guid>
  <label>Convert CRM Name To Granite One</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="crmAttributeName" type="rifp">
      <type>dtype_stcw.attributeName</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var result = null;

    if(stcc.stringHasValue(crmAttributeName)) {
          var convertValueFinder = new Finder ("stcw:convertCRMToGraniteName");
          convertValueFinder.searchDocument.crmAttributeName     = crmAttributeName.toUpperCase();
          convertValueFinder.search ();

          var resultList = convertValueFinder.list;

          if (resultList != null && resultList.size > 0) {
                result = resultList.start.graniteAttributeName;
          }
          else {
                result = crmAttributeName;
          }
    }

    return result;
  ]]></script>
</script>