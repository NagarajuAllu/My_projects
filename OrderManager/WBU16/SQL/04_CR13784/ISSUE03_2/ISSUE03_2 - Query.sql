set serveroutput on
DECLARE

  TYPE ServiceNumberList IS TABLE OF VARCHAR2(500);
  my_services ServiceNumberList;

  CURSOR serviceData (servNumber VARCHAR2) IS
      SELECT l.servicenumber      ||';'|| 
             l.oldservicenumber   ||';'||
             l.lineitemidentifier ||';'||
             l.lineitemstatus     ||';'||
             h.customeridnumber   ||';'||
             h.customername       ||';'||
             h.customernumber     ||';'||
             l.workordernumber    ||';'||
             l.producttype        ||';'||
             l.servicetype        ||';'||
             l.provisioningFlag   ||';'||
             h.ismigrated  serviceData
        FROM stcw_lineitem l, stcw_bundleorder_header h
       WHERE l.cworderid=h.cworderid
         AND l.provisioningFlag in ('ACTIVE', 'PROVISIONING')
         AND (l.servicenumber = servNumber OR l.oldservicenumber = servNumber);


  errorMsg       VARCHAR2(1000);
  found          NUMBER(1);
  
BEGIN
  
  DBMS_OUTPUT.ENABLE(NULL);

  my_services := ServiceNumberList(
'C002-0000087-A',
'C002-0000060-A',
'C002-0000073-A',
'C011-1000013-A',
'C002-0000035-A',
'D016-0000027-A',
'SD05-0000018-A',
'C002-1000081-A',
'C002-1000057-A',
'C002-0000030-A',
'C002-1000023-A',
'CL01-000000231-A',
'C003-1000001-A',
'C001-2000001-A',
'C007-0000003-A',
'C002-2000090-A',
'C011-1000016-A',
'C001-2000117-A',
'C004-1000005-A',
'C007-0000025-A',
'C002-1000015-A',
'D15I-2000104-A',
'C004-4000201-A',
'D15I-2000015-A',
'SD05-0000012-A',
'C001-2000072-A',
'C002-1000070-A',
'C002-1000025-A',
'D15I-1000009-A',
'D003-0000035-E',
'C001-2000064-A',
'C001-2000063-A',
'C002-0000077-A',
'C026-0000103-A',
'C001-2000015-A',
'C002-0000047-A',
'C002-1000071-A',
'SD05-0000007-A',
'SD05-0000017-A',
'D15N-1000001-A',
'C001-2000056-A',
'C026-0000107-B',
'D003-0000026-A',
'SD05-0000022-A',
'C002-0000049-A',
'C002-1000051-A',
'C002-2000028-A',
'CL01-1002178-A',
'D016-0000023-A',
'CL01-1002029-A',
'C002-0000040-A',
'D15I-1000013-A',
'D003-0000022-A',
'D15I-2000020-A',
'C002-1000082-A',
'C002-0000037-A',
'D15I-1000011-A',
'CL01-1002179-A',
'D016-0000053-A',
'C002-1000011-A',
'C002-1000007-A',
'D15I-1000021-A',
'C001-2000033-A',
'C007-0000009-A',
'D003-0000065-A',
'D016-0000028-A',
'CL01-000000231-A',
'D003-0000049-B',
'C002-1000052-A',
'C003-1000010-A',
'C027-0000004-A',
'C002-0000058-A',
'C004-1000003-A',
'C002-0000101-A',
'C026-0000117-B',
'D016-0000022-A',
'SD05-0000009-A',
'C002-0000097-A',
'C001-1000627-A',
'C002-1000005-A',
'C020-0000069-B',
'C026-0000116-B',
'C004-0000010-A',
'C002-1000078-A',
'C001-2000020-A',
'SD05-0000023-A',
'C001-2000017-A',
'C002-0000028-A',
'C004-0000074-A',
'C002-1000053-A',
'C004-4000127-A',
'SD05-0000020-A',
'C002-1000021-A',
'D003-0000005-B',
'SD05-0000002-A',
'D003-0000058-A',
'C002-0000094-A',
'D003-0000064-A',
'C002-1000048-A',
'C002-1000001-A',
'D003-0000030-A',
'SD05-0000019-A',
'D003-0000077-A',
'D003-0000068-B',
'C002-1000064-A',
'C002-1000037-A',
'D15I-2000013-A',
'C002-0000057-A',
'C002-0000104-A',
'C001-2000078-A',
'SD05-0000017-A',
'C002-1000038-A',
'C024-0000003-A',
'D15I-2000119-A',
'D003-0000020-A',
'D15I-2000022-A',
'C004-0000041-A',
'C001-2000034-A',
'C001-1000692-A',
'C002-1000032-A',
'C002-1000074-A',
'C001-2000069-A',
'C002-0000031-A',
'C026-0000133-A',
'D003-0000025-A',
'D003-0000003-B',
'D003-0000006-B',
'D003-0000002-B',
'SD05-0000030-A',
'CL01-1002246-A',
'C004-1000003-A',
'C002-1000030-A',
'CL01-000000231-A',
'C004-1000080-A',
'C002-0000027-A',
'C002-1000058-A',
'C004-1000019-A',
'C002-1000035-A',
'C002-1000079-A',
'C004-1000033-A',
'C027-0000048-A',
'C002-0000110-A',
'C002-1000060-A',
'C004-1000004-A',
'CL01-1002178-A',
'C027-0000088-A',
'D016-0000044-A',
'D15I-2000125-A',
'C002-0000086-A',
'SD06-0000000-A',
'SD05-0000019-A',
'C002-1000014-A',
'D016-0000039-A',
'C002-0000045-A',
'C007-0000012-A',
'C026-0000115-B',
'D003-0000015-A',
'C026-0000111-A',
'D15I-2000010-B',
'C002-1000006-A',
'D003-0000152-A',
'C002-1000044-A',
'SD05-0000019-A',
'C002-0000103-A',
'C002-0000052-A',
'C001-2000019-A',
'SD05-0000010-A',
'SD05-0000028-A',
'C001-2000024-A',
'D003-0000028-A',
'C002-1000024-A',
'C002-1000072-A',
'C027-0000073-C',
'C002-0000102-A',
'D15I-1000010-A',
'D003-0000055-C',
'C002-1000039-A',
'C027-0000006-A',
'C002-1000056-A',
'C002-0000095-A',
'C002-0000111-A',
'C002-1000008-A',
'C027-0000136-A',
'C003-1000007-A',
'SD05-0000006-A',
'D016-0000022-A',
'D003-0000012-A',
'C003-1000008-A',
'C027-9000133-A',
'C002-0000050-A',
'D003-0000001-B',
'SD05-0000007-A',
'SD05-0000018-A',
'C002-1000073-A',
'SD05-0000031-A',
'C002-1000009-A',
'C002-1000010-A',
'C002-1000043-A',
'C002-1000012-A',
'C002-0000003-A',
'C004-4000143-A',
'SD06-0000016-A',
'C001-2000051-A',
'C002-0000006-A',
'C004-4000194-A',
'C027-9000148-A',
'C002-1000033-A',
'C002-1000028-A',
'C002-0000067-A',
'SD05-0000017-A',
'C001-2000021-A',
'D003-0000029-C',
'D003-0000040-A',
'C002-1000047-A',
'CL01-000000231-A',
'D003-0000036-B',
'C002-0000118-A',
'D003-0000019-A',
'C002-0000059-A',
'SD05-0000013-A',
'C027-0000005-A',
'C026-0000134-A',
'C002-1000068-A',
'SD05-0000014-A',
'C001-2000061-A',
'SD05-0000023-A',
'C002-1000040-A',
'CL01-000000147-A',
'D003-0000044-B',
'SD05-0000015-A',
'C004-1000010-A',
'D003-0000148-A',
'C001-2000044-A',
'CL01-1002246-A',
'D003-0000045-B',
'C004-1000001-A',
'4-9729222',
'C002-1000046-A',
'C002-0000005-A',
'D15N-1000002-A',
'C004-4000151-A',
'C002-0000120-A',
'C002-0000093-A',
'4-9719068',
'C026-0000113-A',
'C004-0000059-A',
'D15I-2000039-A',
'C027-0000008-C',
'D003-0000057-A',
'C004-0000089-A',
'SD05-0000023-A',
'D003-0000018-A',
'D003-0000059-A',
'C026-0000099-A',
'D016-0000031-A',
'C002-0000032-A',
'D15I-2000110-A',
'D003-0000039-A',
'D003-0000063-A',
'C002-0000042-A',
'C002-0000053-A',
'SD05-0000008-A',
'D15I-2000027-A',
'D016-0000036-A',
'D016-0000021-A',
'C026-0000130-A',
'SD05-0000019-A',
'C026-1000099-A',
'SD05-0000032-A',
'C026-0000114-A',
'C003-1000011-A',
'D15I-1000012-A',
'SD06-0000007-A',
'D003-0000053-D',
'C002-0000084-A',
'C002-1000026-A',
'C002-1000006-A',
'D003-0000041-B',
'D003-0000027-A',
'C002-1000018-A',
'C002-1000002-A',
'C002-2000049-A',
'4-9729223',
'SD06-0000001-A',
'C003-1000002-A',
'D15I-2000107-A',
'C002-0000109-A',
'C002-1000004-A',
'C027-0000096-A',
'C002-1000063-A',
'C002-0000071-A',
'C002-1000059-A',
'SD06-0000017-A',
'SD05-0000009-A',
'C002-1000020-A',
'C026-0000118-B',
'C004-1000002-A',
'D003-0000011-A',
'C002-0000036-A',
'SD05-0000024-A',
'D15I-2000006-A',
'C002-1000075-A',
'CL01-1002036-A',
'D15I-2000141-A',
'C002-0000026-A',
'C002-0000043-A',
'CL01-000000231-A',
'SD05-0000007-A',
'C001-2000022-A',
'C004-0000089-A',
'C002-1000013-A',
'CL01-1002036-A',
'C026-0000102-A',
'C001-2000053-A',
'C002-2000117-A',
'SD05-0000016-A',
'C002-1000019-A',
'C002-1000067-A',
'SD05-0000010-A',
'D15I-2000011-A',
'D003-0000052-D',
'D003-0000013-A',
'C026-0000110-A',
'C002-2000027-A',
'C001-2000039-A',
'D027-0000001-A',
'SD06-0000015-A',
'D15I-2000027-A',
'D15I-1000020-A',
'CL01-1002180-A',
'C002-0000012-A',
'D003-0000032-A',
'D023-0000122-A',
'C002-1000061-A',
'C002-2000112-A',
'C002-0000090-A',
'C004-0000045-A',
'C002-0000038-A',
'C002-1000004-A',
'D016-0000031-A',
'D003-0000051-B',
'SD05-0000007-A',
'C026-0000128-A',
'C027-0000050-A',
'C002-0000029-A',
'D15I-1000019-A',
'D003-0000033-A',
'C002-0000044-A',
'C002-0000022-A',
'D003-0000130-A',
'C002-1000080-A',
'D003-0000042-A',
'C003-1000009-A',
'C002-1000041-A',
'D003-0000024-A',
'C002-0000039-A',
'C002-1000022-A',
'C004-0000121-B',
'C004-0000001-A',
'C026-0000105-A',
'D003-0000056-C',
'D15I-2000007-A',
'SD05-0000020-A',
'D15I-2000140-A',
'C002-1000016-A',
'CL01-000000231-A',
'SD05-0000020-A',
'C026-0000098-A',
'C002-0000099-A',
'C001-2000068-A',
'D003-0000031-A',
'D003-0000061-A',
'C002-1000042-A',
'C002-0000100-A',
'SD05-0000024-A',
'C001-2000055-A',
'C002-1000069-A',
'C026-0000108-A',
'C027-0000079-B',
'C002-1000062-A',
'C002-1000065-A',
'C002-1000031-A',
'C006-0000008-A',
'SD05-0000002-A',
'C001-2000083-A',
'CL01-000000231-A',
'C001-2000119-A',
'C007-0000037-A',
'C001-2000062-A',
'SD05-0000022-A',
'C002-1000055-A',
'D023-0000100-A',
'C002-0000069-A',
'C026-0000106-B',
'C002-2000047-A',
'SD05-0000008-A',
'C001-2000018-A',
'C011-1000014-A',
'SD05-0000009-A',
'C007-0000001-A',
'C002-1000003-A',
'SD05-0000010-A',
'SD06-0000009-A',
'C002-0000033-A',
'C002-1000007-A',
'C002-0000096-A',
'D003-0000074-A',
'C002-1000036-A',
'C002-0000061-A',
'C002-0000041-A',
'C007-0000002-A',
'D003-0000008-A',
'SD05-0000009-A',
'SD05-0000008-A',
'C026-0000111-A',
'D003-0000016-A',
'C002-1000054-A',
'C002-0000020-A',
'C002-1000076-A',
'C002-0000108-A',
'C002-1000017-A',
'D15I-2000001-A',
'C002-1000029-A',
'C002-1000034-A',
'SD05-0000011-A',
'SD05-0000005-A',
'C001-1000696-A',
'D003-0000066-C',
'C026-0000129-A',
'C004-0000064-A',
'D003-0000126-A',
'D15I-1000002-A',
'C001-2000032-A',
'SD05-0000017-A',
'D003-0000004-B',
'CL01-000999-A',
'C004-0000002-B',
'SD05-0000025-A',
'C007-0000029-A',
'SD05-0000008-A',
'SD05-0000029-A',
'D003-0000037-B',
'C002-0000070-A',
'D003-0000023-A',
'SD05-0000010-A',
'D003-0000060-B',
'D15N-1000003-A',
'C002-1000049-A',
'D15I-1000001-A',
'C002-0000075-A',
'C002-1000005-A',
'C002-2000109-A',
'D016-0000033-A',
'D003-0000014-A',
'C002-1000045-A',
'C002-0000034-A',
'D15I-2000033-A',
'C026-0000131-A',
'C026-0000104-A',
'D003-0000043-A',
'C002-1000066-A',
'SD05-0000020-A',
'C002-1000050-A',
'C003-1000006-A',
'SD05-0000023-A',
'C004-0000052-A',
'C002-1000077-A',
'D023-0000124-A'
);

  FOR i IN my_services.FIRST .. my_services.LAST
  LOOP
--    DBMS_OUTPUT.PUT_LINE('Processing serviceNumber['||i||']: '||my_services(i));

    errorMsg  := null;
    found     := 0;
    
    BEGIN 
      FOR s IN serviceData(my_services(i)) LOOP
        BEGIN
          found := 1;
          DBMS_OUTPUT.PUT_LINE(s.serviceData);
        EXCEPTION
          WHEN others THEN
            errorMsg := substr(sqlerrm, 1, 1000);
            DBMS_OUTPUT.PUT_LINE('ERROR ---> '||my_services(i)||':'||errorMsg);
        END;
      END LOOP;
      
      IF(found = 0) THEN
        DBMS_OUTPUT.PUT_LINE('ERROR ---> '||my_services(i)||': NO RECORD FOUND');
      END IF;
      
    EXCEPTION
      WHEN others THEN
        errorMsg := substr(sqlerrm, 1, 1000);
        DBMS_OUTPUT.PUT_LINE('ERROR ---> GENERIC ERROR: '||errorMsg);
    END;
    
  END LOOP;

END;