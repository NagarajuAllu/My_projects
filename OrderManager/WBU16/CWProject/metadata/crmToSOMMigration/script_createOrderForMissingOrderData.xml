<?xml version="1.0" encoding="UTF-8" ?>
<script name="crmToSOMMigration.createOrderForMissingOrderData">
  <highlight>14</highlight>
  <label>Create Order For Missing OrderData</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="dataForMissingOrder" type="rifp">
      <type>doc_crmToSOMMigration.STCW_DATA_FOR_MISSING_ORDERS</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var bundleOrder = null;

    if(dataForMissingOrder != null) {

        bundleOrder = new Order("stcw.wholesaleBundleOrderSTC");
        bundleOrder.orderHeader.customerIdNumber = dataForMissingOrder.customerIdNumber;
        bundleOrder.orderHeader.accountNumber    = dataForMissingOrder.customerIdNumber;
        bundleOrder.orderHeader.orderNumber      = dataForMissingOrder.orderNumber;
        bundleOrder.orderHeader.orderType        = dataForMissingOrder.orderType;
        bundleOrder.orderHeader.orderStatus      = dataForMissingOrder.orderStatus;
        bundleOrder.orderHeader.creationDate     = dataForMissingOrder.creationDate;
        bundleOrder.orderHeader.createdBy        = dataForMissingOrder.createdBy;
        bundleOrder.orderHeader.createdByName    = dataForMissingOrder.createdBy;
        bundleOrder.orderHeader.serviceDate      = dataForMissingOrder.serviceDate;
        bundleOrder.orderHeader.businessUnit     = dataForMissingOrder.businessUnit;
        bundleOrder.orderHeader.completionDate   = dataForMissingOrder.completionDate;
        bundleOrder.orderHeader.receiveDate      = new Date();
        bundleOrder.orderHeader.isMigrated       = true;

        var orderItemPathForBundle = "parentLineItems.1";
        var bundleDoc = bundleOrder.createOrderItemByPath(orderItemPathForBundle + ".parentLineItem");

        bundleDoc.lineItemIdentifier          = dataForMissingOrder.lineItemIdentifier;
        bundleDoc.lineItemStatus              = dataForMissingOrder.lineItemStatus;
        bundleDoc.lineItemType                = dataForMissingOrder.lineItemType;
        bundleDoc.priority                    = 1;
        bundleDoc.action                      = dataForMissingOrder.action;
        bundleDoc.workOrderNumber             = dataForMissingOrder.workOrderNumber;
        bundleDoc.workOrderType               = dataForMissingOrder.action;
        bundleDoc.serviceType                 = dataForMissingOrder.serviceType;
        bundleDoc.serviceNumber               = dataForMissingOrder.serviceNumber;
        bundleDoc.reservationNumber           = dataForMissingOrder.reservationNumber;
        bundleDoc.productCode                 = dataForMissingOrder.productCode;
        bundleDoc.quantity                    = 1;
        bundleDoc.bandwidth                   = dataForMissingOrder.bandwidth;
        bundleDoc.locationACity               = dataForMissingOrder.locationACity;
        bundleDoc.locationACCLICode           = dataForMissingOrder.locationACCLICode;
        bundleDoc.locationAAccessType         = dataForMissingOrder.locationAAccessType;
        bundleDoc.locationBCity               = dataForMissingOrder.locationBCity;
        bundleDoc.locationBCCLICode           = dataForMissingOrder.locationBCCLICode;
        bundleDoc.locationBAccessType         = dataForMissingOrder.locationBAccessType;
        bundleDoc.serviceDate                 = dataForMissingOrder.serviceDate;
        bundleDoc.creationDate                = dataForMissingOrder.creationDate;
        bundleDoc.elementTypeInOrderTree      = "B";
        bundleDoc.isSubmit                    = true;
        bundleDoc.isCancel                    = false;
        bundleDoc.alreadySentToGranite        = true;
        bundleDoc.alreadyReceivedCancel       = false;
        bundleDoc.sentAnytimeToGranite        = true;
        bundleDoc.requestedActionIsA          = (dataForMissingOrder.action == "A");
        bundleDoc.provisioningFlag            = "ACTIVE";
        bundleDoc.provisioningBU              = dataForMissingOrder.provisioningBU;
        bundleDoc.versionNumber               = null;
        bundleDoc.completionDate              = dataForMissingOrder.completionDate;
        bundleDoc.receivedAction              = dataForMissingOrder.action;
        bundleDoc.receivedServiceType         = dataForMissingOrder.serviceType;
    }

    return bundleOrder;
  ]]></script>
</script>