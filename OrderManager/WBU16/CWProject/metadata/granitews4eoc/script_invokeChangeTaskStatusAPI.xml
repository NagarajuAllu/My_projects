<?xml version="1.0" encoding="UTF-8" ?>
<script name="granitews4eoc.invokeChangeTaskStatusAPI">
  <label>Invoke &quot;Change Task Status&quot; API</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="taskInstId" type="rifp">
      <type>dtype_granite.INST_ID_10</type>
    </parameter>
    <parameter name="newStatusCode" type="rifp">
      <type>dtype_com.conceptwave.system.Integer</type>
    </parameter>
    <parameter name="userId" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="woName" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="taskName" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var debugLog = "InvokeChangeTaskStatusAPI";
    var resultDS =  null;

    try {
        var inputDS = new DataStructure("granitews4eoc.changeTaskStatus_el");
        inputDS.ChangeTaskStatusInputMessage.taskInstId = taskInstId;
        inputDS.ChangeTaskStatusInputMessage.newStatusCode = newStatusCode;
        inputDS.ChangeTaskStatusInputMessage.userId = userId;

        resultDS = stcc.sendDataToInterfaceWithLogging(inputDS,
                                                       "granitews4eoc.GraniteServiceForEOCPortType",
                                                       "changeTaskStatus",
                                                       true,
                                                       null,
                                                       debugLog,
                                                       woName,
                                                       taskName);

    }
    catch(exc) {
        var errorType = "Application";

        if(exc.message.indexOf("XE0023") >= 0 || exc.message.indexOf("XE0002")) {
    debugPrintln(stcc.getSysdateForLog() + " " + debugLog + " (" + taskInstId + ", " + newStatusCode + "): Interface Error while invoking Granite For EOC WS: " + exc.message);
            errorType = "Interface";
        }
        else {
    debugPrintln(stcc.getSysdateForLog() + " " + debugLog + " (" + taskInstId + ", " + newStatusCode + "): Application Error while invoking Granite For EOC WS: " + exc.message);
            errorType = "Application";
        }

        resultDS = new DataStructure("granitews4eoc.changeTaskStatusResponse_el");
        resultDS.ResultMessage.result = "ERROR";
        resultDS.ResultMessage.errorCode = "WS0001";
        resultDS.ResultMessage.errorDescription = exc.message;
    }

    debugPrintln(stcc.getSysdateForLog() + " " + debugLog + " (" + taskInstId + ", " + newStatusCode + "): Response = " + resultDS.toXML());

    return resultDS;
  ]]></script>
</script>