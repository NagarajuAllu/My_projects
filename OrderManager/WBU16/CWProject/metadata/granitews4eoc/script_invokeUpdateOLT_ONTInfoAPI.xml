<?xml version="1.0" encoding="UTF-8" ?>
<script name="granitews4eoc.invokeUpdateOLT_ONTInfoAPI">
  <label>Invoke &quot;Update OLT_ONT Info&quot; API</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="oltEquipInstId" type="rifp">
      <type>dtype_granite.INST_ID_10</type>
    </parameter>
    <parameter name="oltPortInstId" type="rifp">
      <type>dtype_granite.INST_ID_10</type>
    </parameter>
    <parameter name="oltUDAs" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
    <parameter name="ontEquipInstId" type="rifp">
      <type>dtype_granite.INST_ID_10</type>
    </parameter>
    <parameter name="ontSerialNumber" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="taskInstId" type="rifp">
      <type>dtype_granite.INST_ID_10</type>
    </parameter>
    <parameter name="userId" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="ontUDAs" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
    <parameter name="woName" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="taskName" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var debugLog = "InvokeUpdateOLT_ONTInfoAPI";
    var resultDS =  null;

    try {
        var inputDSForOLT = new DataStructure("granitews4eoc.updateOLTInfoPojo");
        inputDSForOLT.portInstId = oltPortInstId;
        inputDSForOLT.equipInstId = oltEquipInstId;
        if(oltUDAs != null) {
            for(var i=0; i<oltUDAs.length; i++) {
                inputDSForOLT.udaDetailsPojos[i] = new DataStructure("granitews4eoc.udaDetailsPojo");
                inputDSForOLT.udaDetailsPojos[i].udaName = oltUDAs[i].udaName;
                inputDSForOLT.udaDetailsPojos[i].udaGroup = oltUDAs[i].udaGroup;
                inputDSForOLT.udaDetailsPojos[i].udaValue = oltUDAs[i].udaValue;
            }
        }

        var inputDSForONT = new DataStructure("granitews4eoc.updateONTInfoPojo");
        inputDSForONT.equipInstId = ontEquipInstId;
        inputDSForONT.serialNo = ontSerialNumber;
        inputDSForONT.taskInstId = taskInstId;
        inputDSForONT.userId = userId;
        if(ontUDAs != null) {
            for(var i=0; i<ontUDAs.length; i++) {
                inputDSForONT.udaDetailsPojos[i] = new DataStructure("granitews4eoc.udaDetailsPojo");
                inputDSForONT.udaDetailsPojos[i].udaName = ontUDAs[i].udaName;
                inputDSForONT.udaDetailsPojos[i].udaGroup = ontUDAs[i].udaGroup;
                inputDSForONT.udaDetailsPojos[i].udaValue = ontUDAs[i].udaValue;
            }
        }

        var inputDS = new DataStructure("granitews4eoc.updateOLT_ONTInfo_el");
        inputDS.UpdateOLT_ONTInfoInputMessage.updateOLTInfoPojo = inputDSForOLT;
        inputDS.UpdateOLT_ONTInfoInputMessage.updateONTInfoPojo = inputDSForONT;

        resultDS = stcc.sendDataToInterfaceWithLogging(inputDS,
                                                       "granitews4eoc.GraniteServiceForEOCPortType",
                                                       "updateOLT_ONTInfo",
                                                       true,
                                                       null,
                                                       debugLog,
                                                       woName,
                                                       taskName);

    }
    catch(exc) {
        var errorType = "Application";

        if(exc.message.indexOf("XE0023") >= 0 || exc.message.indexOf("XE0002")) {
    debugPrintln(stcc.getSysdateForLog() + " " + debugLog + " (" + oltEquipInstId + ", " + oltPortInstId + ", " + ontEquipInstId + "): Interface Error while invoking Granite For EOC WS: " + exc.message);
            errorType = "Interface";
        }
        else {
    debugPrintln(stcc.getSysdateForLog() + " " + debugLog + " (" + oltEquipInstId + ", " + oltPortInstId + ", " + ontEquipInstId + "): Application Error while invoking Granite For EOC WS: " + exc.message);
            errorType = "Application";
        }

        resultDS = new DataStructure("granitews4eoc.updateOLT_ONTInfoResponse_el");
        resultDS.ResultMessage.result = "ERROR";
        resultDS.ResultMessage.errorCode = "WS0001";
        resultDS.ResultMessage.errorDescription = exc.message;
    }

    debugPrintln(stcc.getSysdateForLog() + " " + debugLog + " (" + oltEquipInstId + ", " + oltPortInstId + ", " + ontEquipInstId + "): Response = " + resultDS.toXML());

    return resultDS;
  ]]></script>
</script>