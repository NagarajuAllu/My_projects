<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="4f9b1a9857a248d229e6eda4abfed687" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="stcw.extractObjectFromInterfaceMessage">
  <guid>{015c5736-57b4-8ea7-36bc-5bb908a67afe}</guid>
  <label>Extract Object From Interface Message</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="order" type="rifp">
      <mandatory>true</mandatory>
      <type>order_com.conceptwave.system.Order</type>
    </parameter>
    <parameter name="versionNumber" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.Integer</type>
    </parameter>
    <parameter name="interfaceName" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="structureName" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <valueType>nmeta_com.conceptwave.system.Object</valueType>
  <script><![CDATA[
    var interfaceFolder = stcw.findLastInterfaceFolder (order, interfaceName, versionNumber);
    var msg = null;
    var requiredObject = null;

    if(interfaceFolder != null) {
          msg = interfaceFolder.interfaceData.responseData;
    }

    if(msg != null) {
          requiredObject = stcw.readStructure( msg, structureName );
    }

    return requiredObject;
  ]]></script>
</script>