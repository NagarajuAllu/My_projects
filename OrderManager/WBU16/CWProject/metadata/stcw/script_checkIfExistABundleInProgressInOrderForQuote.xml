<?xml version="1.0" encoding="UTF-8" ?>
<script name="stcw.checkIfExistABundleInProgressInOrderForQuote">
  <label>Check If Exist A Bundle In Progress In Order For Quote</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="bundleOrder" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var found = false;

    for(var i=0; i<bundleOrder.parentLineItems.length && !found; i++) {
        var parentLineItemStatus = bundleOrder.parentLineItems[i].parentLineItem.lineItemStatus.toUpperCase();
        found = (parentLineItemStatus != "FEASIBLE" &&
                 parentLineItemStatus != "NOT FEASIBLE" &&
                 parentLineItemStatus != "PLANNED FEASIBLE" &&
                 parentLineItemStatus != "CANCELLED" &&
                 parentLineItemStatus != "PARTIALLY_FEASIBLE" &&
                 parentLineItemStatus != "NOT_FEASIBLE" &&
                 parentLineItemStatus != "COMPLETED");
    }

    debugPrintln(stcc.getSysdateForLog() + " checkIfExistABundleInProgressInOrderForQuote(" + bundleOrder.orderHeader.orderNumber + "): " + found);

    return found;
  ]]></script>
</script>