<?xml version="1.0" encoding="UTF-8" ?>
<script name="stcw.performValidationForParentServiceInHierarchy">
  <label>Perform Validation For Parent Service In Hierarchy</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="orderType" type="rifp">
      <type>dtype_wsws.orderType</type>
    </parameter>
    <parameter name="isBundle" type="rifp">
      <type>dtype_com.conceptwave.system.Boolean</type>
    </parameter>
    <parameter name="lineItem" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
    <parameter name="isSubmit" type="rifp">
      <type>dtype_com.conceptwave.system.Boolean</type>
    </parameter>
    <parameter name="failureArray" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var validationErrors = null;

    if(isBundle) {
        if(orderType == "C") {
            if(lineItem.action == "D") {
                if(stcw.isParentInServiceTypeHierarchy(lineItem.receivedServiceType)) {
                    validationErrors = stcw.appendToValidationErrors("AE0176", Global.translateText("AE0176", null, [lineItem.lineItemIdentifier]), validationErrors);
                }
            }
        }
    }

    if(validationErrors != null) {
    debugPrintln(stcc.getSysdateForLog() + " performValidationForParentServiceInHierarchy (" + lineItem.lineItemIdentifier + "): Found Error 'AE0176' because the path is parent, has action 'D', orderType is 'C' and it's a bundle");
        failureArray = stcw.addValidationErrorsToFailureArrayForSub_UpdInWD(validationErrors, lineItem.lineItemIdentifier, failureArray, isSubmit);
    }

    return failureArray;
  ]]></script>
</script>