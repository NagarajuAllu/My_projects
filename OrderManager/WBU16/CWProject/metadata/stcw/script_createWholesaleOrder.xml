<?xml version="1.0" encoding="UTF-8" ?>
<script filenameHash="ee7e39ad00b7ba2d935116786698326b" versionHash="eccbc87e4b5ce2fe28308fd9f2a7baf3" name="stcw.createWholesaleOrder">
  <guid>{0430f5b2-f4e9-3ffc-2157-e956b114191f}</guid>
  <label>Create Wholesale Order</label>
  <metaVersion>3</metaVersion>
  <parameterList>
    <parameter name="input" type="rifp">
      <mandatory>true</mandatory>
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <valueType>order_com.conceptwave.system.Order</valueType>
  <script><![CDATA[
    var order = new Order ("stcw:wholesaleOrder");

    order.header.orderAction       = "Add";
    order.header.orderNumber       = input.orderNumber;
    order.header.completedDate     = null;
    order.header.orderStatus       = input.orderStatus;
    order.header.orderType         = input.orderType;
    order.header.productCode       = input.service.productCode;
    order.header.quoteNumber       = input.quoteNumber;
    order.header.skipSendToGranite = "N";

    // According to mail sent to Maksym & Ravi 05/06/2010, we expect
    // reservationNumber at Order level and Service level are the same
    // so, if it's set to Order number we use this, else we try to use
    // the Service one.
    var reservationNumber = null;
    if (stcc.stringHasValue (input.reservationNumber)) {
          reservationNumber = input.reservationNumber;
    }
    else if(stcc.stringHasValue(input.service.reservationNumber)) {
          reservationNumber = input.service.reservationNumber;
    }
    order.header.reservationNumber = reservationNumber;

    if (order.versions == null) {
          order.addItem ("versions");
    }

    var orderVersion = order.versions.newInstance ();
    orderVersion.header.versionName = "INITIAL";

    return (order);
  ]]></script>
</script>