<?xml version="1.0" encoding="UTF-8" ?>
<script name="workflow.startBIProcess">
  <label>Start Blocking Issue Process</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="biOrder" type="rifp">
      <type>order_tfs.biOrder</type>
    </parameter>
    <parameter name="userId" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    workflow.setUserInUsersForOrder(biOrder.id, "0", "BI", userId);
    // setting the Users4Order to BI mgmt
    var finder = new Finder("workflow.usersForOrderFinder");
    finder.searchDocument.orderId = biOrder.id;
    finder.searchDocument.orderItemId = "0";
    var recordsFound = finder.search();

    if(recordsFound != null && recordsFound.length > 0) {
        recordsFound[0].isForDefaultProcess = false;
        recordsFound[0].save();
    }

    var processId = Process.startProcess("workflow.blockingIssueProcess", biOrder.id);

    debugPrintln("BI Process started with id " + processId + "; order: <" + biOrder.id + "," + biOrder.biDocument.biId + ">");

    return processId;
  ]]></script>
</script>