<?xml version="1.0" encoding="UTF-8" ?>
<findSql name="up_priv.getDepartmentByUserIdFinder">
  <dbSchema>ORDER</dbSchema>
  <extends>find_com.conceptwave.system.Finder</extends>
  <input>doc_cwf_up.UserIDSearch</input>
  <label>Get Department By UserId Finder</label>
  <maxRowsLimit>999</maxRowsLimit>
  <metaVersion>25</metaVersion>
  <output>doc_cwf_up.group</output>
  <type>SQL</type>
  <methodList>
    <method name="cwOnFinderSQLSel" type="action">
      <system>true</system>
      <script><![CDATA[
        select distinct r.roleid, r.role_name, r.calendar
          from cwrole r, cwusergroupprivilege ugp, cwuserrole ur
         where r.roleid = ugp.usergroup
           and ugp.privilege like 'STC_%'
           and ur.roleid = r.roleid
           and ur.roleid not in (select usergroup from cwusergroupprivilege where privilege = 'STC_GroupMgrPriv')
        {[0] and ur.userid = ?}
      ]]></script>
    </method>
  </methodList>
</findSql>