<?xml version="1.0" encoding="UTF-8" ?>
<findSql name="tfs.findOpenBIForPRN_TFR">
  <dbSchema>ORDER</dbSchema>
  <extends>find_com.conceptwave.system.Finder</extends>
  <input>doc_tfs.STC_BI_RELATIONSHIP</input>
  <label>Find Open BI For PRN and TFR </label>
  <maxRowsLimit>100</maxRowsLimit>
  <metaVersion>25</metaVersion>
  <output>doc_tfs.STC_BI</output>
  <type>SQL</type>
  <volatility>0</volatility>
  <methodList>
    <method name="cwOnFinderSQLSel" type="action">
      <system>true</system>
      <script><![CDATA[
        select {+*+}
          from stc_bi
         where bi_id in (select bi.bi_id
                           from stc_bi bi, stc_bi_relationship r
                           where nvl(bi.completion_processed, 0) <> 1
                             and r.bi_id = bi.bi_id
                         {[1] and r.source_prn_id = ?}
                         {[2] and r.source_tfr_id = ?}
                         )
      ]]></script>
    </method>
  </methodList>
</findSql>