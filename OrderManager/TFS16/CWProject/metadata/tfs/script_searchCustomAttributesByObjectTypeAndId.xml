<?xml version="1.0" encoding="UTF-8" ?>
<script name="tfs.searchCustomAttributesByObjectTypeAndId">
  <label>Search Custom Attributes By ObjectType And Id</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="parentObjectType" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="customAttributeId" type="rifp">
      <type>dtype_cwf.docId</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var result = null;
    var finderName = null;

    if(parentObjectType == "PRNR") {
        finderName = "tfs.findPRNRCustomAttribute";
    }
    else if(parentObjectType == "PRN") {
        finderName = "tfs.findPRNCustomAttribute";
    }
    else if(parentObjectType == "TFR") {
        finderName = "tfs.findTFRCustomAttribute";
    }
    else if(parentObjectType == "BI") {
        finderName = "tfs.findBICustomAttribute";
    }

    if(finderName != null) {
        var finderCustomAttributes = new Finder(finderName);
        finderCustomAttributes.searchDocument.objectId = null;
        finderCustomAttributes.searchDocument.customAttributeId = customAttributeId;
        result = finderCustomAttributes.search();
    }

    return result;
  ]]></script>
</script>