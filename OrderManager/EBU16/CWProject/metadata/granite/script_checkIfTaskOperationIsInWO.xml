<?xml version="1.0" encoding="UTF-8" ?>
<script name="granite.checkIfTaskOperationIsInWO">
  <label>Check If Task Operation Is In WO</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="woInstId" type="rifp">
      <type>dtype_granite.INST_ID</type>
    </parameter>
    <parameter name="expectedTaskOperation" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var existsTaskOperation = false;

    if (woInstId != null && expectedTaskOperation != null) {

       var inputDoc = new Document("granite.search_GraniteInstId");
       inputDoc.INST_ID = woInstId;

       var resultList = Finder.runFinder("granite.findTasksForWO", "select", inputDoc);

       if (resultList != null) {
           for(var i=0; i<resultList.length && !existsTaskOperation; i++) {
               existsTaskOperation = (resultList[i].TASK_OPERATION == expectedTaskOperation);
           }
       }
    }

    return existsTaskOperation;
  ]]></script>
</script>