<?xml version="1.0" encoding="UTF-8" ?>
<script name="granite.getWONameForElement">
  <label>Get WOName For Element</label>
  <metaVersion>25</metaVersion>
  <parameterList>
    <parameter name="elementType" type="rifp">
      <type>dtype_granite.ELEMENT_TYPE</type>
    </parameter>
    <parameter name="elementInstId" type="rifp">
      <type>dtype_granite.INST_ID_16</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var result = null;

    if (elementType != null && elementInstId != null) {

       var input = new Document("granite.search_WOElementType_InstId");
       input.elementInstId = elementInstId;
       input.elementType = elementType;

       var output = Finder.runFinder("granite.findWOInGraniteByElementInstIdAndType", "select", input);

       if (output != null && output.size > 0) {
          result = output[0].WO_NAME;
       }
    }

    return result;
  ]]></script>
</script>